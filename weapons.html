<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weapons - Army Weapons Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white">
    
    <!-- Navbar -->
    <nav class="bg-gray-800 p-4 shadow-lg flex justify-between">
        <h1 class="text-2xl font-bold">Army Weapons Management</h1>
        <ul class="flex space-x-4 ml-auto">
            <li><a href="Dashboard.html" class="hover:text-gray-300">Dashboard</a></li>
            <li><a href="weapons.html" class="hover:text-gray-300 font-bold">Weapons</a></li>
            <li><a href="ammunition.html" class="hover:text-gray-300">Ammunition</a></li>
            <li><a href="personnel.html" class="hover:text-gray-300">Personnel</a></li>
            <li><a href="storage.html" class="hover:text-gray-300">Storage</a></li>
            <li><a href="logs.html" class="hover:text-gray-300">Logs</a></li>
        </ul>
    </nav>
    
    <!-- Weapons Management -->
    <section id="weapons" class="p-6">
        <h2 class="text-3xl font-bold mb-6">Weapons Management</h2>
        
        <!-- Search and Add Section -->
        <div class="flex justify-between mb-6">
            <div class="w-1/3">
                <input type="text" id="searchWeapons" placeholder="Search weapons..." 
                    class="w-full p-2 bg-gray-700 rounded-md border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <button id="addWeaponBtn" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-md">
                Add New Weapon
            </button>
        </div>
        
        <!-- Filters Section -->
        <div class="flex justify-between mb-6">
            <div class="flex space-x-4">
                <select id="weaponTypeFilter" class="p-2 bg-gray-700 rounded-md border border-gray-600">
                    <option value="">All Types</option>
                    <option value="Rifle">Rifle</option>
                    <option value="Pistol">Pistol</option>
                    <option value="Machine Gun">Machine Gun</option>
                    <option value="Sniper">Sniper</option>
                    <option value="Other">Other</option>
                </select>
                <select id="statusFilter" class="p-2 bg-gray-700 rounded-md border border-gray-600">
                    <option value="">All Statuses</option>
                    <option value="Active">Active</option>
                    <option value="Maintenance">Maintenance</option>
                    <option value="Decommissioned">Decommissioned</option>
                </select>
                <select id="assignmentFilter" class="p-2 bg-gray-700 rounded-md border border-gray-600">
                    <option value="">All Assignments</option>
                    <option value="assigned">Assigned</option>
                    <option value="unassigned">Unassigned</option>
                </select>
            </div>
            <button id="clearFiltersBtn" class="bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded-md">
                Clear Filters
            </button>
        </div>
        
        <!-- Weapons Table -->
        <div class="overflow-x-auto">
            <table class="min-w-full bg-gray-800 rounded-lg overflow-hidden">
                <thead class="bg-gray-700">
                    <tr>
                        <th class="py-3 px-4 text-left">ID</th>
                        <th class="py-3 px-4 text-left">Name</th>
                        <th class="py-3 px-4 text-left">Type</th>
                        <th class="py-3 px-4 text-left">Serial Number</th>
                        <th class="py-3 px-4 text-left">Status</th>
                        <th class="py-3 px-4 text-left">Assigned To</th>
                        <th class="py-3 px-4 text-left">Actions</th>
                    </tr>
                </thead>
                <tbody id="weaponsTableBody">
                    <!-- Sample data, will be populated by JavaScript -->
                </tbody>
            </table>
        </div>
    </section>
    
    <!-- Add/Edit Weapon Modal -->
    <div id="weaponModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
        <div class="bg-gray-800 p-6 rounded-lg w-1/2">
            <h3 id="modalTitle" class="text-xl font-bold mb-4">Add New Weapon</h3>
            <form id="weaponForm">
                <input type="hidden" id="weaponId">
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="weaponName" class="block mb-1">Weapon Name</label>
                        <input type="text" id="weaponName" class="w-full p-2 bg-gray-700 rounded-md border border-gray-600">
                    </div>
                    <div>
                        <label for="weaponType" class="block mb-1">Type</label>
                        <select id="weaponType" class="w-full p-2 bg-gray-700 rounded-md border border-gray-600">
                            <option value="Rifle">Rifle</option>
                            <option value="Pistol">Pistol</option>
                            <option value="Machine Gun">Machine Gun</option>
                            <option value="Sniper">Sniper</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div>
                        <label for="serialNumber" class="block mb-1">Serial Number</label>
                        <input type="text" id="serialNumber" class="w-full p-2 bg-gray-700 rounded-md border border-gray-600">
                    </div>
                    <div>
                        <label for="status" class="block mb-1">Status</label>
                        <select id="status" class="w-full p-2 bg-gray-700 rounded-md border border-gray-600">
                            <option value="Active">Active</option>
                            <option value="Maintenance">Maintenance</option>
                            <option value="Decommissioned">Decommissioned</option>
                        </select>
                    </div>
                    <div>
                        <label for="assignedTo" class="block mb-1">Assigned To</label>
                        <input type="text" id="assignedTo" class="w-full p-2 bg-gray-700 rounded-md border border-gray-600">
                    </div>
                </div>
                <div class="flex justify-end space-x-3">
                    <button type="button" id="cancelWeaponBtn" class="bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded-md">Cancel</button>
                    <button type="submit" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-md">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Footer -->
    <footer class="text-center p-4 bg-gray-800 mt-6">
        <p>Â© 2025 Army Weapons Management System</p>
    </footer>

    <script>
        // Sample weapon data
        let weapons = [
            { id: 1, name: "M4A1", type: "Rifle", serialNumber: "R12345", status: "Active", assignedTo: "John Doe" },
            { id: 2, name: "Glock 19", type: "Pistol", serialNumber: "P67890", status: "Active", assignedTo: "Jane Smith" },
            { id: 3, name: "M249", type: "Machine Gun", serialNumber: "M54321", status: "Maintenance", assignedTo: "" }
        ];

        // DOM elements
        const searchWeapons = document.getElementById('searchWeapons');
        const weaponsTableBody = document.getElementById('weaponsTableBody');
        const addWeaponBtn = document.getElementById('addWeaponBtn');
        const weaponModal = document.getElementById('weaponModal');
        const modalTitle = document.getElementById('modalTitle');
        const weaponForm = document.getElementById('weaponForm');
        const cancelWeaponBtn = document.getElementById('cancelWeaponBtn');
        const weaponIdInput = document.getElementById('weaponId');
        const weaponTypeFilter = document.getElementById('weaponTypeFilter');
        const statusFilter = document.getElementById('statusFilter');
        const assignmentFilter = document.getElementById('assignmentFilter');
        const clearFiltersBtn = document.getElementById('clearFiltersBtn');

        // Render weapons table
        function renderWeaponsTable(weaponsArray = weapons) {
            weaponsTableBody.innerHTML = '';
            
            weaponsArray.forEach(weapon => {
                const row = document.createElement('tr');
                row.classList.add('border-t', 'border-gray-700', 'hover:bg-gray-750');
                
                row.innerHTML = `
                    <td class="py-3 px-4">${weapon.id}</td>
                    <td class="py-3 px-4">${weapon.name}</td>
                    <td class="py-3 px-4">${weapon.type}</td>
                    <td class="py-3 px-4">${weapon.serialNumber}</td>
                    <td class="py-3 px-4">
                        <span class="px-2 py-1 rounded-full text-xs ${
                            weapon.status === 'Active' ? 'bg-green-700' : 
                            weapon.status === 'Maintenance' ? 'bg-yellow-700' : 'bg-red-700'
                        }">${weapon.status}</span>
                    </td>
                    <td class="py-3 px-4">${weapon.assignedTo || 'Not assigned'}</td>
                    <td class="py-3 px-4">
                        <button class="text-blue-400 hover:text-blue-300 mr-2 edit-btn" data-id="${weapon.id}">Edit</button>
                        <button class="text-red-400 hover:text-red-300 delete-btn" data-id="${weapon.id}">Delete</button>
                    </td>
                `;
                
                weaponsTableBody.appendChild(row);
            });
            
            // Add event listeners for edit and delete buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    editWeapon(id);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    deleteWeapon(id);
                });
            });
        }

        // Apply filters
        function applyFilters() {
            let filteredWeapons = weapons;
            
            // Search filter
            const searchTerm = searchWeapons.value.toLowerCase();
            if (searchTerm) {
                filteredWeapons = filteredWeapons.filter(weapon => 
                    weapon.name.toLowerCase().includes(searchTerm) ||
                    weapon.type.toLowerCase().includes(searchTerm) ||
                    weapon.serialNumber.toLowerCase().includes(searchTerm) ||
                    weapon.status.toLowerCase().includes(searchTerm) ||
                    (weapon.assignedTo && weapon.assignedTo.toLowerCase().includes(searchTerm))
                );
            }
            
            // Type filter
            const typeFilter = weaponTypeFilter.value;
            if (typeFilter) {
                filteredWeapons = filteredWeapons.filter(weapon => 
                    weapon.type === typeFilter
                );
            }
            
            // Status filter
            const statusValue = statusFilter.value;
            if (statusValue) {
                filteredWeapons = filteredWeapons.filter(weapon => 
                    weapon.status === statusValue
                );
            }
            
            // Assignment filter
            const assignmentValue = assignmentFilter.value;
            if (assignmentValue === 'assigned') {
                filteredWeapons = filteredWeapons.filter(weapon => 
                    weapon.assignedTo && weapon.assignedTo.trim() !== ''
                );
            } else if (assignmentValue === 'unassigned') {
                filteredWeapons = filteredWeapons.filter(weapon => 
                    !weapon.assignedTo || weapon.assignedTo.trim() === ''
                );
            }
            
            renderWeaponsTable(filteredWeapons);
        }

        // Update search functionality to use applyFilters
        searchWeapons.addEventListener('input', applyFilters);

        // Add event listeners for filters
        weaponTypeFilter.addEventListener('change', applyFilters);
        statusFilter.addEventListener('change', applyFilters);
        assignmentFilter.addEventListener('change', applyFilters);

        // Clear filters
        clearFiltersBtn.addEventListener('click', function() {
            searchWeapons.value = '';
            weaponTypeFilter.value = '';
            statusFilter.value = '';
            assignmentFilter.value = '';
            renderWeaponsTable();
        });

        // Show add weapon modal
        addWeaponBtn.addEventListener('click', function() {
            modalTitle.textContent = 'Add New Weapon';
            weaponForm.reset();
            weaponIdInput.value = '';
            weaponModal.classList.remove('hidden');
        });

        // Cancel button in modal
        cancelWeaponBtn.addEventListener('click', function() {
            weaponModal.classList.add('hidden');
        });

        // Form submission
        weaponForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const id = weaponIdInput.value ? parseInt(weaponIdInput.value) : weapons.length > 0 ? Math.max(...weapons.map(w => w.id)) + 1 : 1;
            const name = document.getElementById('weaponName').value;
            const type = document.getElementById('weaponType').value;
            const serialNumber = document.getElementById('serialNumber').value;
            const status = document.getElementById('status').value;
            const assignedTo = document.getElementById('assignedTo').value;
            
            if (weaponIdInput.value) {
                // Edit existing weapon
                const index = weapons.findIndex(w => w.id === parseInt(weaponIdInput.value));
                if (index !== -1) {
                    weapons[index] = { id, name, type, serialNumber, status, assignedTo };
                }
            } else {
                // Add new weapon
                weapons.push({ id, name, type, serialNumber, status, assignedTo });
            }
            
            applyFilters(); // Apply current filters to the updated data
            weaponModal.classList.add('hidden');
        });

        // Edit weapon
        function editWeapon(id) {
            const weapon = weapons.find(w => w.id === id);
            if (weapon) {
                modalTitle.textContent = 'Edit Weapon';
                weaponIdInput.value = weapon.id;
                document.getElementById('weaponName').value = weapon.name;
                document.getElementById('weaponType').value = weapon.type;
                document.getElementById('serialNumber').value = weapon.serialNumber;
                document.getElementById('status').value = weapon.status;
                document.getElementById('assignedTo').value = weapon.assignedTo || '';
                
                weaponModal.classList.remove('hidden');
            }
        }

        // Delete weapon
        function deleteWeapon(id) {
            if (confirm('Are you sure you want to delete this weapon?')) {
                weapons = weapons.filter(w => w.id !== id);
                applyFilters(); // Apply current filters to the updated data
            }
        }

        // Initial render
        renderWeaponsTable();
    </script>
</body>
</html>